<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Consistency With the Results of Existing GDM R Packages • gdverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Consistency With the Results of Existing GDM R Packages">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/gd.html">Geographical Detector(GD)</a></li>
    <li><a class="dropdown-item" href="../articles/opgd.html">Optimal Parameters-based Geographical Detector(OPGD)</a></li>
    <li><a class="dropdown-item" href="../articles/shegd.html">Spatial Heterogeneity Explanation(GOZH&amp;LESH)</a></li>
    <li><a class="dropdown-item" href="../articles/spade.html">Spatial Association Detector(SPADE)</a></li>
    <li><a class="dropdown-item" href="../articles/idsa.html">Interactive Detector For Spatial Associations(IDSA)</a></li>
    <li><a class="dropdown-item" href="../articles/rgdrid.html">Robust Geographical Detector&amp;Robust Interaction Detector(RGD&amp;RID)</a></li>
    <li><a class="dropdown-item" href="../articles/sesu.html">Compare Size Effect of Spatial Units(SESU)</a></li>
    <li><a class="dropdown-item" href="../articles/consistency.html">Consistency With the Results of Existing GDM R Packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stscl/gdverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Consistency With the Results of Existing GDM R Packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stscl/gdverse/blob/main/vignettes/consistency.Rmd" class="external-link"><code>vignettes/consistency.Rmd</code></a></small>
      <div class="d-none name"><code>consistency.Rmd</code></div>
    </div>

    
    
<p>This vignette discusses the consistency of results between the factor
detector in the <code>gdverse</code> package and existing R packages of
GDModels (i.e., <code>geodetector</code> and <code>GD</code> packages).
Use the <code>NTDs</code> data from <code>gdverse</code> package as the
demo;</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NTDs</span> <span class="op">=</span> <span class="fu">gdverse</span><span class="fu">::</span><span class="va"><a href="../reference/NTDs.html">NTDs</a></span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="va">res1</span> <span class="op">=</span> <span class="fu">gdverse</span><span class="fu">::</span><span class="fu"><a href="../reference/gd.html">gd</a></span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">NTDs</span><span class="op">)</span></span>
<span><span class="va">res1</span></span>
<span><span class="co">##                 Factor Detector            </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## | variable  | Q-statistic |   P-value   |</span></span>
<span><span class="co">## |:---------:|:-----------:|:-----------:|</span></span>
<span><span class="co">## | watershed |  0.6377737  | 0.000128803 |</span></span>
<span><span class="co">## | elevation |  0.6067087  | 0.043382244 |</span></span>
<span><span class="co">## | soiltype  |  0.3857168  | 0.372145486 |</span></span>
<span></span>
<span><span class="va">res2</span> <span class="op">=</span> <span class="fu">GD</span><span class="fu">::</span><span class="fu">gd</span><span class="op">(</span><span class="va">incidence</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">NTDs</span><span class="op">)</span></span>
<span><span class="va">res2</span></span>
<span><span class="co">##    variable        qv         sig</span></span>
<span><span class="co">## 1 watershed 0.6377737 0.000128803</span></span>
<span><span class="co">## 2 elevation 0.6067087 0.043382244</span></span>
<span><span class="co">## 3  soiltype 0.3857168 0.372145486</span></span>
<span></span>
<span><span class="co"># The geodetector package do not support the `tibble`</span></span>
<span><span class="va">res3</span> <span class="op">=</span> <span class="fu">geodetector</span><span class="fu">::</span><span class="fu">factor_detector</span><span class="op">(</span><span class="st">"incidence"</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"soiltype"</span>,<span class="st">"watershed"</span>,<span class="st">"elevation"</span><span class="op">)</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">NTDs</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res3</span></span>
<span><span class="co">## [[1]]</span></span>
<span><span class="co">##          q-statistic   p-value</span></span>
<span><span class="co">## soiltype   0.3857168 0.3632363</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##           q-statistic      p-value</span></span>
<span><span class="co">## watershed   0.6377737 0.0001169914</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[3]]</span></span>
<span><span class="co">##           q-statistic    p-value</span></span>
<span><span class="co">## elevation   0.6067087 0.04080407</span></span></code></pre></div>
<p>The q-statistic calculations for all variables in the three packages
are consistent, but there are slight differences in the results of the
q-values. Among them, <code>gdverse</code> is consistent with the
<code>GD</code> package, and there are differences with the
<code>geodetector</code> package. This is caused by the inconsistent
choice of the non-central F-distribution parameters of the p-value for
the q-statistic; when there is only one sample in a certain
stratification, it cannot calculate the variance and therefore does not
contribute to the q-statistic calculation. The <code>gdverse</code> and
<code>GD</code> packages use the same strategy, which is to directly
remove these single-sample stratas, but the <code>geodetector</code>
package calculates the total sample size and stratification number
directly before data processing, so it causes a slight difference in the
estimation of the p-value for the q-statistic. In actual problems, this
situation occurs less frequently. We believe that using the actual
number of samples and stratifications participating in the calculation
is more prudent, so we chose the same processing strategy as the
<code>GD</code> package.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>, <a href="https://layeyo.github.io/" class="external-link">Yangyang Lei</a>, <a href="https://github.com/ddl196" class="external-link">Fangmei Liu</a>, <a href="https://geog.snnu.edu.cn/info/1061/1288.htm" class="external-link">Jianwu Yan</a>, <a href="https://yongzesong.com/" class="external-link">Yongze Song</a>, <a href="https://wufan-zhao.github.io/" class="external-link">Wufan Zhao</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
