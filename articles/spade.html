<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Spatial Association Detector(SPADE) • gdverse</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Spatial Association Detector(SPADE)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdverse</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/gd.html">Geographical Detector(GD)</a></li>
    <li><a class="dropdown-item" href="../articles/opgd.html">Optimal Parameters-based Geographical Detector(OPGD)</a></li>
    <li><a class="dropdown-item" href="../articles/shegd.html">Spatial Heterogeneity Explanation(GOZH&amp;LESH)</a></li>
    <li><a class="dropdown-item" href="../articles/spade.html">Spatial Association Detector(SPADE)</a></li>
    <li><a class="dropdown-item" href="../articles/idsa.html">Interactive Detector For Spatial Associations(IDSA)</a></li>
    <li><a class="dropdown-item" href="../articles/rgdrid.html">Robust Geographical Detector&amp;Robust Interaction Detector(RGD&amp;RID)</a></li>
    <li><a class="dropdown-item" href="../articles/sesu.html">Compare Size Effect of Spatial Units(SESU)</a></li>
    <li><a class="dropdown-item" href="../articles/consistency.html">Consistency With the Results of Existing GDM R Packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stscl/gdverse/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spatial Association Detector(SPADE)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stscl/gdverse/blob/main/vignettes/spade.Rmd" class="external-link"><code>vignettes/spade.Rmd</code></a></small>
      <div class="d-none name"><code>spade.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="load-data-and-package">Load data and package<a class="anchor" aria-label="anchor" href="#load-data-and-package"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stscl.github.io/gdverse/">gdverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">depression</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/Depression.csv'</span>,package <span class="op">=</span> <span class="st">'gdverse'</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">read_csv</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X'</span>,<span class="st">'Y'</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">depression</span></span>
<span><span class="co">## Simple feature collection with 1072 features and 11 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -83.1795 ymin: 32.11464 xmax: -78.6023 ymax: 35.17354</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 1,072 × 12</span></span>
<span><span class="co">##    Depression_prevelence PopulationDensity Population65 NoHealthInsurance Neighbor_Disadvantage</span></span>
<span><span class="co">##  *                 &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;             &lt;dbl&gt;                 &lt;dbl&gt;</span></span>
<span><span class="co">##  1                  23.1              61.5         22.5              7.98               -0.0525</span></span>
<span><span class="co">##  2                  22.8              58.3         16.8             11.0                -0.254 </span></span>
<span><span class="co">##  3                  23.2              35.9         24.5              9.31               -0.0540</span></span>
<span><span class="co">##  4                  21.8              76.1         21.8             13.2                 0.0731</span></span>
<span><span class="co">##  5                  20.7              47.3         22.0             11                   0.763 </span></span>
<span><span class="co">##  6                  21.3              32.5         19.2             13.0                 0.422 </span></span>
<span><span class="co">##  7                  22                36.9         19.2             10.8                 0.113 </span></span>
<span><span class="co">##  8                  21.2              61.5         15.9              8.57               -0.154 </span></span>
<span><span class="co">##  9                  22.7              67.2         15.7             17.8                -0.320 </span></span>
<span><span class="co">## 10                  20.6             254.          11.3             12.7                 0.457 </span></span>
<span><span class="co">## # ℹ 1,062 more rows</span></span>
<span><span class="co">## # ℹ 7 more variables: Beer &lt;dbl&gt;, MentalHealthPati &lt;dbl&gt;, NatureParks &lt;dbl&gt;, Casinos &lt;dbl&gt;,</span></span>
<span><span class="co">## #   DrinkingPlaces &lt;dbl&gt;, X.HouseRent &lt;dbl&gt;, geometry &lt;POINT [°]&gt;</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spatial-autocorrelation-of-depression-prevelence">Spatial Autocorrelation of Depression Prevelence<a class="anchor" aria-label="anchor" href="#spatial-autocorrelation-of-depression-prevelence"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gmi</span> <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/moran_test.html" class="external-link">moran_test</a></span><span class="op">(</span><span class="va">depression</span><span class="op">)</span></span>
<span><span class="va">gmi</span></span>
<span><span class="co">## ***                 global moran test</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="28%">
<col width="17%">
<col width="15%">
<col width="14%">
<col width="9%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="center">Variable</th>
<th align="center">MoranI</th>
<th align="center">EI</th>
<th align="center">VarI</th>
<th align="center">zI</th>
<th align="center">pI</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Depression_prevelence</td>
<td align="center">0.339557***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">19.06</td>
<td align="center">2.892e-81</td>
</tr>
<tr class="even">
<td align="center">PopulationDensity</td>
<td align="center">0.365364***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">20.5</td>
<td align="center">1.052e-93</td>
</tr>
<tr class="odd">
<td align="center">Population65</td>
<td align="center">0.180436***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">10.15</td>
<td align="center">1.641e-24</td>
</tr>
<tr class="even">
<td align="center">NoHealthInsurance</td>
<td align="center">0.0791199***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">4.48</td>
<td align="center">3.724e-06</td>
</tr>
<tr class="odd">
<td align="center">Neighbor_Disadvantage</td>
<td align="center">0.113811***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">6.422</td>
<td align="center">6.723e-11</td>
</tr>
<tr class="even">
<td align="center">Beer</td>
<td align="center">0.0902263***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">5.102</td>
<td align="center">1.68e-07</td>
</tr>
<tr class="odd">
<td align="center">MentalHealthPati</td>
<td align="center">0.19318***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">10.86</td>
<td align="center">8.534e-28</td>
</tr>
<tr class="even">
<td align="center">NatureParks</td>
<td align="center">0.0895589***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">5.065</td>
<td align="center">2.045e-07</td>
</tr>
<tr class="odd">
<td align="center">Casinos</td>
<td align="center">0.243212***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">13.66</td>
<td align="center">8.28e-43</td>
</tr>
<tr class="even">
<td align="center">DrinkingPlaces</td>
<td align="center">0.239054***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">13.43</td>
<td align="center">1.97e-41</td>
</tr>
<tr class="odd">
<td align="center">X.HouseRent</td>
<td align="center">0.141887***</td>
<td align="center">-0.0009337</td>
<td align="center">0.0003192</td>
<td align="center">7.993</td>
<td align="center">6.562e-16</td>
</tr>
</tbody>
</table>
<p>The global Moran’I Index of Depression Prevelence is
<code>0.339557</code> and the P value is <code>2.892e-81</code>, which
shows that Depression Prevelence has a moderate level of positive
spatial autocorrelation in the global scale.</p>
</div>
<div class="section level3">
<h3 id="opgd-modeling">OPGD modeling<a class="anchor" aria-label="anchor" href="#opgd-modeling"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_opgd</span> <span class="op">=</span> <span class="fu"><a href="../reference/opgd.html">opgd</a></span><span class="op">(</span><span class="va">Depression_prevelence</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                       data <span class="op">=</span> <span class="va">depression</span>, cores <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">depression_opgd</span></span>
<span><span class="co">## ***   Optimal Parameters-based Geographical Detector     </span></span>
<span><span class="co">##                 Factor Detector            </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## |       variable        | Q-statistic |   P-value    |</span></span>
<span><span class="co">## |:---------------------:|:-----------:|:------------:|</span></span>
<span><span class="co">## | Neighbor_Disadvantage | 0.13979930  | 4.960000e-10 |</span></span>
<span><span class="co">## |   PopulationDensity   | 0.09186679  | 2.328052e-01 |</span></span>
<span><span class="co">## |     Population65      | 0.08956911  | 1.000000e+00 |</span></span>
<span><span class="co">## |   NoHealthInsurance   | 0.06779068  | 6.479536e-01 |</span></span>
<span><span class="co">## |      NatureParks      | 0.05963161  | 1.000000e+00 |</span></span>
<span><span class="co">## |    DrinkingPlaces     | 0.05411512  | 1.000000e+00 |</span></span>
<span><span class="co">## |      X.HouseRent      | 0.03439383  | 1.000000e+00 |</span></span>
<span><span class="co">## |         Beer          | 0.01410217  | 1.000000e+00 |</span></span>
<span><span class="co">## |   MentalHealthPati    | 0.01295799  | 1.000000e+00 |</span></span>
<span><span class="co">## |        Casinos        | 0.01207694  | 1.000000e+00 |</span></span></code></pre></div>
<p><strong>You can access the detailed q statistics by
<code>depression_opgd$factor</code></strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_opgd</span><span class="op">$</span><span class="va">factor</span></span>
<span><span class="co">## # A tibble: 10 × 3</span></span>
<span><span class="co">##    variable              `Q-statistic` `P-value`</span></span>
<span><span class="co">##    &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">##  1 Neighbor_Disadvantage        0.140   4.96e-10</span></span>
<span><span class="co">##  2 PopulationDensity            0.0919  2.33e- 1</span></span>
<span><span class="co">##  3 Population65                 0.0896  1.00e+ 0</span></span>
<span><span class="co">##  4 NoHealthInsurance            0.0678  6.48e- 1</span></span>
<span><span class="co">##  5 NatureParks                  0.0596  1.00e+ 0</span></span>
<span><span class="co">##  6 DrinkingPlaces               0.0541  1.00e+ 0</span></span>
<span><span class="co">##  7 X.HouseRent                  0.0344  1.00e+ 0</span></span>
<span><span class="co">##  8 Beer                         0.0141  1   e+ 0</span></span>
<span><span class="co">##  9 MentalHealthPati             0.0130  1.00e+ 0</span></span>
<span><span class="co">## 10 Casinos                      0.0121  1   e+ 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spatial-weight-matrix">Spatial Weight Matrix<a class="anchor" aria-label="anchor" href="#spatial-weight-matrix"></a>
</h3>
<p><em>SPADE</em> explicitly considers the spatial variance by assigning
the weight of the influence based on spatial distribution and also
minimizes the influence of the number of levels on PD values by using
the multilevel discretization and considering information loss due to
discretization.</p>
<p>When response variable has a strong spatial dependence, maybe
<em>SPADE</em> is a best choice.</p>
<p>The biggest difference between SPADE and native GD and OPGD in actual
modeling is that SPADE requires a spatial weight matrix to calculate
spatial variance.</p>
<p>I have also developed the <a href="https://stscl.github.io/sdsfun/" class="external-link">sdsfun</a> package to facilitate
the construction of spatial weight matrices, which requires an input of
an sf object.</p>
<p>In <code>spade</code> function, when you not provide a spatial weight
matrix, it will use <strong>1st order inverse distance weight</strong>
by default, which can be created by
<code><a href="https://stscl.github.io/sdsfun/reference/inverse_distance_swm.html" class="external-link">sdsfun::inverse_distance_swm()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt1</span> <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/inverse_distance_swm.html" class="external-link">inverse_distance_swm</a></span><span class="op">(</span><span class="va">depression</span><span class="op">)</span></span></code></pre></div>
<p>You can also use gravity model weight by assigning the
<code>power</code> parameter in
<code><a href="https://stscl.github.io/sdsfun/reference/inverse_distance_swm.html" class="external-link">sdsfun::inverse_distance_swm()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt2</span> <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/inverse_distance_swm.html" class="external-link">inverse_distance_swm</a></span><span class="op">(</span><span class="va">depression</span>,power <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Or using a spatial weight matrix based on geospatial contiguity.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt3</span> <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/spdep_contiguity_swm.html" class="external-link">spdep_contiguity_swm</a></span><span class="op">(</span><span class="va">depression</span>, k <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p>Or using a spatial weight matrix based on distance kernel
functions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wt4</span> <span class="op">=</span> <span class="fu">sdsfun</span><span class="fu">::</span><span class="fu"><a href="https://stscl.github.io/sdsfun/reference/spdep_distance_swm.html" class="external-link">spdep_distance_swm</a></span><span class="op">(</span><span class="va">depression</span>, k <span class="op">=</span> <span class="fl">6</span>, kernel <span class="op">=</span> <span class="st">'gaussian'</span><span class="op">)</span></span></code></pre></div>
<p>The test of <em>SPADE</em> model significance in <code>gdverse</code>
is achieved by randomization null hypothesis use a pseudo-p value, this
calculation is very time-consuming. Default <code>gdverse</code> sets
the <code>permutations</code> parameter to 0 and does not calculate the
pseudo-p value. If you want to calculate the pseudo-p value, specify the
<code>permutations</code> parameter to a number such as 99,999,9999,
etc.</p>
<p>In the following section we will execute <em>SPADE</em> model using
spatial weight matrix <code>wt1</code>.</p>
</div>
<div class="section level3">
<h3 id="spade-modeling">SPADE modeling<a class="anchor" aria-label="anchor" href="#spade-modeling"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_spade</span> <span class="op">=</span> <span class="fu"><a href="../reference/spade.html">spade</a></span><span class="op">(</span><span class="va">Depression_prevelence</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>                         data <span class="op">=</span> <span class="va">depression</span>,</span>
<span>                         wt <span class="op">=</span> <span class="va">wt1</span>, cores <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">depression_spade</span></span>
<span><span class="co">## ***         Spatial Association Detector         </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## |       variable        | Q-statistic |      P-value      |</span></span>
<span><span class="co">## |:---------------------:|:-----------:|:-----------------:|</span></span>
<span><span class="co">## |   PopulationDensity   | 0.21532238  | No Pseudo-P Value |</span></span>
<span><span class="co">## |    DrinkingPlaces     | 0.18564821  | No Pseudo-P Value |</span></span>
<span><span class="co">## |        Casinos        | 0.17438646  | No Pseudo-P Value |</span></span>
<span><span class="co">## | Neighbor_Disadvantage | 0.17235706  | No Pseudo-P Value |</span></span>
<span><span class="co">## |      NatureParks      | 0.17019859  | No Pseudo-P Value |</span></span>
<span><span class="co">## |     Population65      | 0.15592529  | No Pseudo-P Value |</span></span>
<span><span class="co">## |         Beer          | 0.09506759  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   MentalHealthPati    | 0.07956353  | No Pseudo-P Value |</span></span>
<span><span class="co">## |   NoHealthInsurance   | 0.07753293  | No Pseudo-P Value |</span></span>
<span><span class="co">## |      X.HouseRent      | 0.05621546  | No Pseudo-P Value |</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">depression_spade</span>, slicenum <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p><img src="../reference/figures/spade/spade-1.png"></p>
<p><strong>You can also access the detailed q statistics by
<code>depression_spade$factor</code></strong></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">depression_spade</span><span class="op">$</span><span class="va">factor</span></span>
<span><span class="co">## # A tibble: 10 × 3</span></span>
<span><span class="co">##    variable              `Q-statistic` `P-value`        </span></span>
<span><span class="co">##    &lt;chr&gt;                         &lt;dbl&gt; &lt;chr&gt;            </span></span>
<span><span class="co">##  1 PopulationDensity            0.215  No Pseudo-P Value</span></span>
<span><span class="co">##  2 DrinkingPlaces               0.186  No Pseudo-P Value</span></span>
<span><span class="co">##  3 Casinos                      0.174  No Pseudo-P Value</span></span>
<span><span class="co">##  4 Neighbor_Disadvantage        0.172  No Pseudo-P Value</span></span>
<span><span class="co">##  5 NatureParks                  0.170  No Pseudo-P Value</span></span>
<span><span class="co">##  6 Population65                 0.156  No Pseudo-P Value</span></span>
<span><span class="co">##  7 Beer                         0.0951 No Pseudo-P Value</span></span>
<span><span class="co">##  8 MentalHealthPati             0.0796 No Pseudo-P Value</span></span>
<span><span class="co">##  9 NoHealthInsurance            0.0775 No Pseudo-P Value</span></span>
<span><span class="co">## 10 X.HouseRent                  0.0562 No Pseudo-P Value</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>, <a href="https://layeyo.github.io/" class="external-link">Yangyang Lei</a>, <a href="https://github.com/ddl196" class="external-link">Fangmei Liu</a>, <a href="https://geog.snnu.edu.cn/info/1061/1288.htm" class="external-link">Jianwu Yan</a>, <a href="https://yongzesong.com/" class="external-link">Yongze Song</a>, <a href="https://wufan-zhao.github.io/" class="external-link">Wufan Zhao</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
